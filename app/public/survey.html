<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="https://code.jquery.com/jquery.js"></script>
    <title>Survey</title>

    <!-- Latest compiled and minified CSS & JS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

<!-- Font Awesome Glyphicons -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

<!-- Chosen -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>

  </head>
  <body>
    <div class="container">
    <div class="jumbotron">
	<h1>Poll</h1>


  <h3><strong>Your name:</strong></h3>
  <input type="text" id="name" name="name" value="">



<h3><strong>Question 1</strong></h3>
<h4>First ESP declaration.</h4>
<select data-placeholder="" class="chosen-select" id="q1">
  <option value=""></option>
        <option value="1">1 </option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 </option>
    </select>
<br>

<h3><strong>Question 2</strong></h3>
<h4>Second ESP declaration.</h4>
<select data-placeholder="" class="chosen-select" id="q2">
  <option value=""></option>
        <option value="1">1 </option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 </option>
    </select>
<br>

<h3><strong>Question 3</strong></h3>
<h4>Third ESP declaration.</h4>
<select data-placeholder="" class="chosen-select" id="q3">
  <option value=""></option>
        <option value="1">1 </option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 </option>
    </select>
<br>

<br>

    <div>
      <button type="submit" class="btn btn-primary btn-md" id="add-btn">Submit</button>
    </div>
  </div>
</div>

<script type="text/javascript">

  $("#add-btn").on("click", function(event) {
    event.preventDefault();

//values from the form by id -
    var newSurvey = {
      name: $("#name").val().trim(),
      values: [
      $("#q1").val(),
      $("#q2").val(),
      $("#q3").val(),
      $("#q1").val() + $("#q2").val()+ $("#q3").val()
      ]
    };
var localuser = newSurvey;
    // Grab the URL of the website
    var currentURL = window.location.origin;
//sends the 'body' data in the newSurvey variable to the api post new route
    $.post("/api/new", newSurvey)
    .done(function(newSurvey) {
      console.log(newSurvey);
      // console.log(localuser.values[3]);
      // console.log(currentURL);

      var currentUser = localuser.values[3];
      var lowdelta = 999;
      for (var i = 0; i < newSurvey.length - 1 ; i++) {
        // console.log(newSurvey[i].values[3]);
        var thisUserValue = (newSurvey[i].values[3]);
        var thisUser = (newSurvey[i].name);
        // console.log(currentUser);
        // console.log(thisUser);
        var diff = currentUser - thisUserValue;
        diff = Math.abs(diff);
        console.log("dif: " + Math.abs(diff));

        if (lowdelta > diff) {
          var lowdelta = diff;
          var lowdeltaUser = thisUser;
        }

      }
      console.log(lowdelta);
      console.log("Closest: "+lowdeltaUser);

      // console.log(newSurvey[0]);
      // window.location= currentURL + "/api/friends";
    });
  });
</script>


<button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Open Modal</button>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Modal Header</h4>
      </div>
      <div class="modal-body">
        <p>Some text in the modal.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>



</body>
</html>
